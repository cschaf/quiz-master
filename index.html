<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .import-section {
            background: #f8f9ff;
            border: 2px dashed #4facfe;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .import-section:hover {
            background: #f0f4ff;
            transform: translateY(-2px);
        }

        .file-input {
            margin: 20px 0;
        }

        .file-input input[type="file"] {
            display: none;
        }

        .file-label {
            display: inline-block;
            padding: 12px 25px;
            background: #4facfe;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .file-label:hover {
            background: #3a8bfe;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .sample-btn {
            background: #764ba2;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            margin-left: 15px;
            transition: all 0.3s ease;
        }

        .sample-btn:hover {
            background: #5a3a7a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.4);
        }

        .sample-btn-alt {
            background: #ff9800; /* Orange */
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            margin-left: 15px;
            transition: all 0.3s ease;
        }

        .sample-btn-alt:hover {
            background: #f57c00; /* Darker Orange */
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
        }

        .quiz-container {
            display: none;
        }

        .question-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-left: 5px solid #4facfe;
        }

        .question-number {
            background: #4facfe;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .question-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .question-description {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .question-image {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .answers {
            display: grid;
            gap: 15px;
        }

        .answer {
            padding: 20px;
            border: 2px solid #e0e6ff;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .answer:hover {
            border-color: #4facfe;
            background: #f8f9ff;
            transform: translateX(5px);
        }

        .answer.selected {
            border-color: #4facfe;
            background: #f0f4ff;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.2);
        }

        .answer.correct {
            border-color: #4caf50;
            background: #e8f5e8;
        }

        .answer.incorrect {
            border-color: #f44336;
            background: #ffeaea;
        }

        .answer-text {
            flex: 1;
        }

        .answer-image {
            max-width: 100px;
            height: auto;
            border-radius: 8px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4facfe;
            color: white;
        }

        .btn-primary:hover {
            background: #3a8bfe;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e6ff;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .results {
            text-align: center;
            padding: 40px;
        }

        .score {
            font-size: 3em;
            font-weight: bold;
            color: #4facfe;
            margin-bottom: 20px;
        }

        .score-text {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
        }

        .restart-btn {
            background: #764ba2;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1em;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .restart-btn:hover {
            background: #5a3a7a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.4);
        }

        .review-section {
            text-align: left;
            margin-top: 30px;
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
        }

        .review-question {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #f44336;
        }

        .review-question.correct {
            border-left-color: #4caf50;
        }

        .review-question-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .review-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .review-status.correct {
            background: #e8f5e8;
            color: #4caf50;
        }

        .review-status.incorrect {
            background: #ffeaea;
            color: #f44336;
        }

        .review-answers {
            margin-top: 15px;
        }

        .review-answer {
            padding: 10px 15px;
            margin: 8px 0;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .review-answer.user-selected {
            background: #fff3e0;
            border-color: #ff9800;
        }

        .review-answer.correct-answer {
            background: #e8f5e8;
            border-color: #4caf50;
            font-weight: 600;
        }

        .review-answer.user-selected.correct-answer {
            background: #e8f5e8;
            border-color: #4caf50;
        }

        .answer-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }

        .answer-icon.correct {
            background: #4caf50;
        }

        .answer-icon.incorrect {
            background: #f44336;
        }

        .answer-icon.neutral {
            background: #ccc;
        }

        .toggle-review-btn {
            background: #ff9800;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .toggle-review-btn:hover {
            background: #f57c00;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
        }

        .new-quiz-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .new-quiz-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .json-display {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .answer {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† Quiz System</h1>
            <p>Test your knowledge with interactive quizzes</p>
        </div>
        
        <div class="content">
            <div id="import-section" class="import-section">
                <h3>üìÅ Import Quiz Data</h3>
                <p>Upload a JSON file with your quiz questions or try the sample quiz below</p>
                
                <div class="file-input">
                    <label for="jsonFile" class="file-label">
                        üì§ Choose JSON File
                    </label>
                    <input type="file" id="jsonFile" accept=".json">
                    <button class="sample-btn" onclick="loadSampleQuiz()">
                        üéØ Try Sample Quiz
                    </button>
                    <button class="sample-btn-alt" onclick="loadAnimalQuiz()">
                        üêæ Try Animal Quiz
                    </button>
                </div>
                
                <div id="json-format" style="text-align: left; margin-top: 30px;">
                    <h4>Expected JSON Format:</h4>
                    <div class="json-display">{
  "title": "Quiz Title",
  "description": "Quiz Description",
  "questions": [
    {
      "title": "Question Title",
      "description": "Question description (optional)",
      "image": "https://example.com/image.jpg (optional)",
      "answers": [
        {
          "text": "Answer text",
          "image": "https://example.com/answer-image.jpg (optional)",
          "correct": true
        },
        {
          "text": "Another answer",
          "correct": false
        }
      ]
    }
  ]
}</div>
                </div>
            </div>
            
            <div id="quiz-container" class="quiz-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                </div>
                
                <div id="quiz-content"></div>
                
                <div class="controls">
                    <button id="prev-btn" class="btn btn-secondary" onclick="previousQuestion()">
                        ‚Üê Previous
                    </button>
                    <span id="question-counter">1 / 10</span>
                    <button id="next-btn" class="btn btn-primary" onclick="nextQuestion()">
                        Next ‚Üí
                    </button>
                </div>
            </div>
            
            <div id="results" class="results" style="display: none;">
                <div class="score" id="final-score">85%</div>
                <div class="score-text" id="score-text">Great job! You answered 8 out of 10 questions correctly.</div>
                
                <div>
                    <button class="restart-btn" onclick="restartQuiz()">
                        üîÑ Take Quiz Again
                    </button>
                    <button class="toggle-review-btn" onclick="toggleReviewSection()">
                        üìã Review Answers
                    </button>
                    <button class="new-quiz-btn" onclick="loadNewQuiz()">
                        üìÅ Load New Quiz
                    </button>
                </div>
                
                <div id="review-section" class="review-section" style="display: none;">
                    <h3 style="text-align: center; margin-bottom: 20px; color: #333;">üìä Detailed Review</h3>
                    <div id="review-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQuiz = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let showingResults = false;

        // Sample quiz data about Clean Architecture and SOLID principles
        const sampleQuizData = {
            "title": "Clean Architecture & SOLID Principles",
            "description": "Test your knowledge of software architecture and design principles",
            "questions": [
                {
                    "title": "What does the 'S' in SOLID stand for?",
                    "description": "SOLID is an acronym for five design principles intended to make software designs more understandable, flexible, and maintainable.",
                    "answers": [
                        {
                            "text": "Single Responsibility Principle",
                            "correct": true
                        },
                        {
                            "text": "Separation of Concerns",
                            "correct": false
                        },
                        {
                            "text": "Software Responsibility Principle",
                            "correct": false
                        },
                        {
                            "text": "System Reliability Principle",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "Which principle states that software entities should be open for extension but closed for modification?",
                    "description": "This principle encourages developers to write code in a way that new functionality can be added without changing existing code.",
                    "answers": [
                        {
                            "text": "Single Responsibility Principle",
                            "correct": false
                        },
                        {
                            "text": "Open/Closed Principle",
                            "correct": true
                        },
                        {
                            "text": "Liskov Substitution Principle",
                            "correct": false
                        },
                        {
                            "text": "Interface Segregation Principle",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "What is the main goal of Clean Architecture?",
                    "description": "Clean Architecture is a software design philosophy that separates the elements of a design into ring levels.",
                    "answers": [
                        {
                            "text": "To make code run faster",
                            "correct": false
                        },
                        {
                            "text": "To separate concerns and make systems independent of frameworks, UI, databases, and external agencies",
                            "correct": true
                        },
                        {
                            "text": "To reduce the number of lines of code",
                            "correct": false
                        },
                        {
                            "text": "To use the latest programming languages",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "According to the Liskov Substitution Principle, what should be true?",
                    "description": "This principle defines a contractual way to ensure that inheritance is used correctly in object-oriented programming.",
                    "answers": [
                        {
                            "text": "Subclasses should have more methods than their parent classes",
                            "correct": false
                        },
                        {
                            "text": "Objects of a superclass should be replaceable with objects of its subclasses without breaking the application",
                            "correct": true
                        },
                        {
                            "text": "Classes should have only one reason to change",
                            "correct": false
                        },
                        {
                            "text": "Interfaces should be as large as possible",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "What does the Dependency Inversion Principle advocate?",
                    "description": "This principle is about reducing dependencies among the code modules and making the system more modular.",
                    "answers": [
                        {
                            "text": "High-level modules should depend on low-level modules",
                            "correct": false
                        },
                        {
                            "text": "Both high-level and low-level modules should depend on abstractions",
                            "correct": true
                        },
                        {
                            "text": "Abstractions should depend on details",
                            "correct": false
                        },
                        {
                            "text": "Dependencies should be hardcoded",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "In Clean Architecture, which layer contains the business rules?",
                    "description": "Clean Architecture organizes code into layers, each with specific responsibilities and dependencies flowing inward.",
                    "answers": [
                        {
                            "text": "Presentation Layer",
                            "correct": false
                        },
                        {
                            "text": "Infrastructure Layer",
                            "correct": false
                        },
                        {
                            "text": "Domain/Business Layer",
                            "correct": true
                        },
                        {
                            "text": "Data Access Layer",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "What does the Interface Segregation Principle suggest?",
                    "description": "This principle deals with the disadvantages of implementing large interfaces.",
                    "answers": [
                        {
                            "text": "Classes should implement as many interfaces as possible",
                            "correct": false
                        },
                        {
                            "text": "Interfaces should be as large as possible to include all methods",
                            "correct": false
                        },
                        {
                            "text": "Clients should not be forced to depend on interfaces they do not use",
                            "correct": true
                        },
                        {
                            "text": "All classes should share the same interface",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "What is a key characteristic of the Single Responsibility Principle?",
                    "description": "This principle is fundamental to creating maintainable and robust software systems.",
                    "answers": [
                        {
                            "text": "A class should have only one reason to change",
                            "correct": true
                        },
                        {
                            "text": "A class should have as many methods as possible",
                            "correct": false
                        },
                        {
                            "text": "A class should inherit from multiple parent classes",
                            "correct": false
                        },
                        {
                            "text": "A class should handle all system responsibilities",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "In Clean Architecture, what should the dependency direction be?",
                    "description": "The direction of dependencies is crucial for maintaining the architecture's integrity and testability.",
                    "answers": [
                        {
                            "text": "Dependencies should point outward from the center",
                            "correct": false
                        },
                        {
                            "text": "Dependencies should point inward toward the center (business logic)",
                            "correct": true
                        },
                        {
                            "text": "Dependencies should be bidirectional",
                            "correct": false
                        },
                        {
                            "text": "Dependencies don't matter in Clean Architecture",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "What is the main benefit of applying SOLID principles?",
                    "description": "SOLID principles work together to create more maintainable and extensible software systems.",
                    "answers": [
                        {
                            "text": "Code runs significantly faster",
                            "correct": false
                        },
                        {
                            "text": "Reduced memory usage",
                            "correct": false
                        },
                        {
                            "text": "More maintainable, flexible, and testable code",
                            "correct": true
                        },
                        {
                            "text": "Automatic bug detection",
                            "correct": false
                        }
                    ]
                }
            ]
        };

        // Sample quiz data about animals with images
        const animalQuizData = {
            "title": "Amazing Animals Quiz",
            "description": "How well do you know the animal kingdom? This quiz features images to test your visual recognition!",
            "questions": [
                {
                    "title": "Which of these animals is known for laying eggs despite being a mammal?",
                    "answers": [
                        {
                            "text": "Koala",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/4/49/Koala_climbing_tree.jpg",
                            "correct": false
                        },
                        {
                            "text": "Kangaroo",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/0/0c/Kangaroo_and_joey05.jpg",
                            "correct": false
                        },
                        {
                            "text": "Platypus",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/7/78/Platypus.jpg",
                            "correct": true
                        },
                        {
                            "text": "Kiwi",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/d/d4/Apteryx_owenii_qut.jpg",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "What is the fastest land animal?",
                    "answers": [
                        {
                            "text": "Cheetah",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/0/09/TheCheethcat.jpg",
                            "correct": true
                        },
                        {
                            "text": "Peregrine Falcon",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/9/91/Falco_peregrinus_-_01.jpg",
                            "correct": false
                        },
                        {
                            "text": "Sailfish",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/5/52/Sailfish.jpg",
                            "correct": false
                        },
                        {
                            "text": "Pronghorn",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/e/e4/Pronghorn_in_Grasslands_National_Park.jpg",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "Which of these is the largest animal on Earth?",
                    "answers": [
                        {
                            "text": "African Elephant",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/6/63/African_bush_elephant_%28Loxodonta_africana%29_female_with_calf.jpg",
                            "correct": false
                        },
                        {
                            "text": "Giraffe",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/9/9e/Giraffe_Mikumi_National_Park.jpg",
                            "correct": false
                        },
                        {
                            "text": "Blue Whale",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/1/1c/Anim1754_-_Flickr_-_NOAA_Photo_Library.jpg",
                            "correct": true
                        },
                        {
                            "text": "Ostrich",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/9/96/Ostrich_male_in_Ngorongoro.jpg",
                            "correct": false
                        }
                    ]
                },
                {
                    "title": "Which bird is famous for its inability to fly but is the largest bird in the world?",
                    "answers": [
                        {
                            "text": "Penguin",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/0/07/Emperor_Penguin_Manchot_empereur.jpg",
                            "correct": false
                        },
                        {
                            "text": "Ostrich",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/9/96/Ostrich_male_in_Ngorongoro.jpg",
                            "correct": true
                        },
                        {
                            "text": "Kiwi",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/d/d4/Apteryx_owenii_qut.jpg",
                            "correct": false
                        },
                        {
                            "text": "Emu",
                            "image": "https://upload.wikimedia.org/wikipedia/commons/9/9d/Emu_1_-_Tidbinbilla.jpg",
                            "correct": false
                        }
                    ]
                }
            ]
        };

        // File input handler
        document.getElementById('jsonFile').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const quizData = JSON.parse(e.target.result);
                        loadQuiz(quizData);
                    } catch (error) {
                        alert('Error parsing JSON file: ' + error.message);
                    }
                };
                reader.readAsText(file);
            }
        });

        function loadSampleQuiz() {
            loadQuiz(sampleQuizData);
        }

        function loadAnimalQuiz() {
            loadQuiz(animalQuizData);
        }

        function loadQuiz(quizData) {
            if (!quizData.questions || quizData.questions.length === 0) {
                alert('Invalid quiz data: No questions found');
                return;
            }

            currentQuiz = quizData;
            currentQuestionIndex = 0;
            userAnswers = new Array(quizData.questions.length).fill(null);
            showingResults = false;

            document.getElementById('import-section').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            document.getElementById('results').style.display = 'none';

            displayQuestion();
            updateControls();
            updateProgress();
        }

        function displayQuestion() {
            const question = currentQuiz.questions[currentQuestionIndex];
            const quizContent = document.getElementById('quiz-content');
            
            let html = `
                <div class="question-card">
                    <div class="question-number">${currentQuestionIndex + 1}</div>
                    <h2 class="question-title">${question.title}</h2>
            `;

            if (question.description) {
                html += `<p class="question-description">${question.description}</p>`;
            }

            if (question.image) {
                html += `<img src="${question.image}" alt="Question image" class="question-image" onerror="this.style.display='none'">`;
            }

            html += '<div class="answers">';
            
            question.answers.forEach((answer, index) => {
                const isSelected = userAnswers[currentQuestionIndex] === index;
                const selectedClass = isSelected ? 'selected' : '';
                const resultClass = showingResults ? 
                    (answer.correct ? 'correct' : (isSelected ? 'incorrect' : '')) : '';
                
                html += `
                    <div class="answer ${selectedClass} ${resultClass}" onclick="selectAnswer(${index})">
                        <div class="answer-text">${answer.text}</div>
                        ${answer.image ? `<img src="${answer.image}" alt="Answer image" class="answer-image" onerror="this.style.display='none'">` : ''}
                    </div>
                `;
            });

            html += '</div></div>';
            quizContent.innerHTML = html;

            // Update question counter
            document.getElementById('question-counter').textContent = 
                `${currentQuestionIndex + 1} / ${currentQuiz.questions.length}`;
        }

        function selectAnswer(answerIndex) {
            if (showingResults) return;
            
            userAnswers[currentQuestionIndex] = answerIndex;
            displayQuestion();
            updateControls();
        }

        function updateControls() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === currentQuiz.questions.length - 1) {
                nextBtn.textContent = 'Finish Quiz';
                nextBtn.disabled = userAnswers[currentQuestionIndex] === null;
            } else {
                nextBtn.textContent = 'Next ‚Üí';
                nextBtn.disabled = userAnswers[currentQuestionIndex] === null;
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / currentQuiz.questions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
                updateControls();
                updateProgress();
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentQuiz.questions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
                updateControls();
                updateProgress();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            showingResults = true;
            
            // Calculate score
            let correctAnswers = 0;
            currentQuiz.questions.forEach((question, questionIndex) => {
                const userAnswer = userAnswers[questionIndex];
                if (userAnswer !== null && question.answers[userAnswer].correct) {
                    correctAnswers++;
                }
            });

            const percentage = Math.round((correctAnswers / currentQuiz.questions.length) * 100);
            
            // Show results
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            
            document.getElementById('final-score').textContent = percentage + '%';
            document.getElementById('score-text').textContent = 
                `Great job! You answered ${correctAnswers} out of ${currentQuiz.questions.length} questions correctly.`;

            // Generate detailed review
            generateDetailedReview();
        }

        function generateDetailedReview() {
            const reviewContent = document.getElementById('review-content');
            let html = '';

            currentQuiz.questions.forEach((question, questionIndex) => {
                const userAnswer = userAnswers[questionIndex];
                const isCorrect = userAnswer !== null && question.answers[userAnswer].correct;
                const correctAnswerIndex = question.answers.findIndex(answer => answer.correct);

                html += `
                    <div class="review-question ${isCorrect ? 'correct' : ''}">
                        <div class="review-question-title">
                            <span>Question ${questionIndex + 1}: ${question.title}</span>
                            <span class="review-status ${isCorrect ? 'correct' : 'incorrect'}">
                                ${isCorrect ? '‚úì Correct' : '‚úó Incorrect'}
                            </span>
                        </div>
                `;

                if (question.description) {
                    html += `<p style="color: #666; margin: 10px 0; font-size: 0.9em;">${question.description}</p>`;
                }

                html += '<div class="review-answers">';
                
                question.answers.forEach((answer, answerIndex) => {
                    const isUserSelected = userAnswer === answerIndex;
                    const isCorrectAnswer = answer.correct;
                    
                    let answerClass = 'review-answer';
                    let iconClass = 'answer-icon neutral';
                    let iconText = '';
                    
                    if (isCorrectAnswer) {
                        answerClass += ' correct-answer';
                        iconClass = 'answer-icon correct';
                        iconText = '‚úì';
                    }
                    
                    if (isUserSelected) {
                        answerClass += ' user-selected';
                        if (!isCorrectAnswer) {
                            iconClass = 'answer-icon incorrect';
                            iconText = '‚úó';
                        }
                    }

                    html += `
                        <div class="${answerClass}">
                            <div class="${iconClass}">${iconText}</div>
                            <div style="flex: 1;">
                                ${answer.text}
                                ${isUserSelected && !isCorrectAnswer ? ' <em style="color: #f44336;">(Your answer)</em>' : ''}
                                ${isCorrectAnswer ? ' <em style="color: #4caf50;">(Correct answer)</em>' : ''}
                            </div>
                            ${answer.image ? `<img src="${answer.image}" alt="Answer image" style="max-width: 60px; border-radius: 5px;" onerror="this.style.display='none'">` : ''}
                        </div>
                    `;
                });

                html += '</div></div>';
            });

            reviewContent.innerHTML = html;
        }

        function toggleReviewSection() {
            const reviewSection = document.getElementById('review-section');
            const toggleBtn = document.querySelector('.toggle-review-btn');
            
            if (reviewSection.style.display === 'none') {
                reviewSection.style.display = 'block';
                toggleBtn.textContent = 'üìù Hide Review';
            } else {
                reviewSection.style.display = 'none';
                toggleBtn.textContent = 'üìã Review Answers';
            }
        }

        function loadNewQuiz() {
            // Reset all states
            currentQuiz = null;
            currentQuestionIndex = 0;
            userAnswers = [];
            showingResults = false;
            
            // Reset file input
            document.getElementById('jsonFile').value = '';
            
            // Hide results and quiz container, show import section
            document.getElementById('results').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('import-section').style.display = 'block';
            document.getElementById('review-section').style.display = 'none';
            
            // Reset toggle button text
            document.querySelector('.toggle-review-btn').textContent = 'üìã Review Answers';
            
            // Reset progress bar
            document.getElementById('progress-fill').style.width = '0%';
        }

        function reviewAnswers() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            
            currentQuestionIndex = 0;
            displayQuestion();
            
            // Update controls for review mode
            const nextBtn = document.getElementById('next-btn');
            const prevBtn = document.getElementById('prev-btn');
            
            nextBtn.textContent = currentQuestionIndex === currentQuiz.questions.length - 1 ? 'Back to Results' : 'Next ‚Üí';
            nextBtn.disabled = false;
            
            nextBtn.onclick = function() {
                if (currentQuestionIndex < currentQuiz.questions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                    updateProgress();
                    this.textContent = currentQuestionIndex === currentQuiz.questions.length - 1 ? 'Back to Results' : 'Next ‚Üí';
                } else {
                    // Back to results
                    document.getElementById('quiz-container').style.display = 'none';
                    document.getElementById('results').style.display = 'block';
                    nextBtn.onclick = nextQuestion; // Reset to original function
                }
            };
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            userAnswers = new Array(currentQuiz.questions.length).fill(null);
            showingResults = false;
            
            document.getElementById('results').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            document.getElementById('review-section').style.display = 'none';
            document.querySelector('.toggle-review-btn').textContent = 'üìã Review Answers';
            
            displayQuestion();
            updateControls();
            updateProgress();
            
            // Reset next button functionality
            document.getElementById('next-btn').onclick = nextQuestion;
        }
    </script>
</body>
</html>